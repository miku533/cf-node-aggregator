<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>CF èŠ‚ç‚¹èšåˆå™¨ - èŠ‚ç‚¹ç»Ÿè®¡</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, 'Helvetica Neue', Arial, sans-serif;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            min-height: 100vh;
            padding: 20px;
        }

        .container {
            max-width: 1200px;
            margin: 0 auto;
        }

        .header {
            text-align: center;
            color: white;
            margin-bottom: 40px;
        }

        .header h1 {
            font-size: 2.5em;
            margin-bottom: 10px;
            text-shadow: 2px 2px 4px rgba(0,0,0,0.2);
        }

        .header p {
            font-size: 1.1em;
            opacity: 0.9;
        }

        .stats-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
            gap: 20px;
            margin-bottom: 30px;
        }

        .stat-card {
            background: white;
            border-radius: 15px;
            padding: 25px;
            box-shadow: 0 10px 30px rgba(0,0,0,0.2);
            transition: transform 0.3s ease;
        }

        .stat-card:hover {
            transform: translateY(-5px);
        }

        .stat-card h3 {
            color: #667eea;
            font-size: 0.9em;
            text-transform: uppercase;
            letter-spacing: 1px;
            margin-bottom: 10px;
        }

        .stat-card .value {
            font-size: 2.5em;
            font-weight: bold;
            color: #333;
            margin-bottom: 5px;
        }

        .stat-card .label {
            color: #666;
            font-size: 0.9em;
        }

        .search-section {
            background: white;
            border-radius: 15px;
            padding: 30px;
            box-shadow: 0 10px 30px rgba(0,0,0,0.2);
            margin-bottom: 30px;
        }

        .search-section h2 {
            color: #667eea;
            margin-bottom: 20px;
        }

        .search-box {
            display: flex;
            gap: 10px;
            margin-bottom: 20px;
        }

        .search-box input {
            flex: 1;
            padding: 12px 20px;
            border: 2px solid #e0e0e0;
            border-radius: 8px;
            font-size: 1em;
            transition: border-color 0.3s;
        }

        .search-box input:focus {
            outline: none;
            border-color: #667eea;
        }

        .search-box button {
            padding: 12px 30px;
            background: #667eea;
            color: white;
            border: none;
            border-radius: 8px;
            font-size: 1em;
            cursor: pointer;
            transition: background 0.3s;
        }

        .search-box button:hover {
            background: #5568d3;
        }

        .btn-danger {
            background: #dc3545 !important;
        }

        .btn-danger:hover {
            background: #c82333 !important;
        }

        .btn-success {
            background: #28a745 !important;
        }

        .btn-success:hover {
            background: #218838 !important;
        }

        .results {
            margin-top: 20px;
        }

        .node-card {
            background: #f8f9fa;
            border-radius: 10px;
            padding: 15px;
            margin-bottom: 10px;
            border-left: 4px solid #667eea;
        }

        .node-card h4 {
            color: #333;
            margin-bottom: 8px;
        }

        .node-info {
            display: flex;
            gap: 20px;
            flex-wrap: wrap;
            font-size: 0.9em;
            color: #666;
        }

        .node-info span {
            display: flex;
            align-items: center;
            gap: 5px;
        }

        .badge {
            display: inline-block;
            padding: 3px 10px;
            border-radius: 12px;
            font-size: 0.85em;
            font-weight: 500;
        }

        .badge-type {
            background: #e3f2fd;
            color: #1976d2;
        }

        .badge-country {
            background: #f3e5f5;
            color: #7b1fa2;
        }

        .badge-port {
            background: #e8f5e9;
            color: #388e3c;
        }

        .charts-section {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(350px, 1fr));
            gap: 20px;
            margin-bottom: 30px;
        }

        .chart-card {
            background: white;
            border-radius: 15px;
            padding: 25px;
            box-shadow: 0 10px 30px rgba(0,0,0,0.2);
        }

        .chart-card h3 {
            color: #667eea;
            margin-bottom: 20px;
        }

        .chart-item {
            display: flex;
            justify-content: space-between;
            align-items: center;
            padding: 10px 0;
            border-bottom: 1px solid #f0f0f0;
        }

        .chart-item:last-child {
            border-bottom: none;
        }

        .chart-label {
            font-weight: 500;
            color: #333;
        }

        .chart-value {
            color: #667eea;
            font-weight: bold;
        }

        .loading {
            text-align: center;
            padding: 40px;
            color: white;
            font-size: 1.2em;
        }

        .error {
            background: #ffebee;
            color: #c62828;
            padding: 15px;
            border-radius: 8px;
            margin-bottom: 20px;
        }

        .success {
            background: #e8f5e9;
            color: #2e7d32;
            padding: 15px;
            border-radius: 8px;
            margin-bottom: 20px;
        }

        .subscription-section {
            background: white;
            border-radius: 15px;
            padding: 30px;
            box-shadow: 0 10px 30px rgba(0,0,0,0.2);
            margin-bottom: 30px;
        }

        .subscription-section h2 {
            color: #667eea;
            margin-bottom: 20px;
        }

        .subscription-link {
            background: #f8f9fa;
            padding: 15px;
            border-radius: 8px;
            word-break: break-all;
            font-family: monospace;
            margin-bottom: 10px;
        }

        .copy-btn {
            padding: 8px 20px;
            background: #667eea;
            color: white;
            border: none;
            border-radius: 6px;
            cursor: pointer;
            font-size: 0.9em;
            margin-top: 10px;
        }

        .copy-btn:hover {
            background: #5568d3;
        }

        .source-item {
            background: #f8f9fa;
            padding: 15px;
            border-radius: 8px;
            margin-bottom: 10px;
            display: flex;
            justify-content: space-between;
            align-items: center;
            gap: 10px;
        }

        .source-url {
            flex: 1;
            word-break: break-all;
            font-family: monospace;
            font-size: 0.9em;
        }

        .source-actions {
            display: flex;
            gap: 5px;
        }

        .btn-small {
            padding: 6px 12px;
            font-size: 0.85em;
        }

        @media (max-width: 768px) {
            .header h1 {
                font-size: 1.8em;
            }

            .stats-grid {
                grid-template-columns: 1fr;
            }

            .charts-section {
                grid-template-columns: 1fr;
            }

            .source-item {
                flex-direction: column;
                align-items: flex-start;
            }

            .source-actions {
                width: 100%;
                justify-content: flex-end;
            }
        }
    </style>
</head>
<body>
    <div class="container">
        <div class="header">
            <h1>ğŸš€ CF èŠ‚ç‚¹èšåˆå™¨</h1>
            <p>å®æ—¶èŠ‚ç‚¹ç»Ÿè®¡ä¸æŸ¥è¯¢</p>
        </div>

        <div id="loading" class="loading">
            æ­£åœ¨åŠ è½½æ•°æ®...
        </div>

        <div id="error" class="error" style="display: none;"></div>

        <div id="content" style="display: none;">
            <!-- ç»Ÿè®¡å¡ç‰‡ -->
            <div class="stats-grid">
                <div class="stat-card">
                    <h3>æ€»èŠ‚ç‚¹æ•°</h3>
                    <div class="value" id="totalNodes">0</div>
                    <div class="label">å¯ç”¨èŠ‚ç‚¹</div>
                </div>
                <div class="stat-card">
                    <h3>å›½å®¶/åœ°åŒº</h3>
                    <div class="value" id="totalCountries">0</div>
                    <div class="label">è¦†ç›–åœ°åŒº</div>
                </div>
                <div class="stat-card">
                    <h3>è®¢é˜…æº</h3>
                    <div class="value" id="totalSources">0</div>
                    <div class="label">æ•°æ®æ¥æº</div>
                </div>
                <div class="stat-card">
                    <h3>æœ€åæ›´æ–°</h3>
                    <div class="value" id="lastUpdate" style="font-size: 1.2em;">--</div>
                    <div class="label">æ›´æ–°æ—¶é—´</div>
                </div>
            </div>

            <!-- è®¢é˜…æºç®¡ç† -->
            <div class="subscription-section">
                <h2>â• è®¢é˜…æºç®¡ç†</h2>
                <div id="successMessage" class="success" style="display: none;"></div>
                <div id="errorMessage" class="error" style="display: none;"></div>
                
                <div class="search-box">
                    <input type="url" id="sourceInput" placeholder="è¾“å…¥è®¢é˜…æº URLï¼Œä¾‹å¦‚ï¼šhttps://raw.githubusercontent.com/xxx/xxx/main/nodes.txt">
                    <button onclick="addSource()" class="btn-success">æ·»åŠ è®¢é˜…æº</button>
                </div>

                <div id="sourcesList"></div>

                <div style="margin-top: 20px;">
                    <button onclick="fetchAndMergeNodes()" class="search-box button">ğŸ”„ ç«‹å³æŠ“å–å¹¶åˆå¹¶èŠ‚ç‚¹</button>
                    <button onclick="exportConfig()" class="copy-btn" style="margin-left: 10px;">ğŸ“¥ å¯¼å‡ºé…ç½®</button>
                </div>
            </div>

            <!-- è®¢é˜…é“¾æ¥ -->
            <div class="subscription-section">
                <h2>ğŸ“‹ Clash è®¢é˜…é“¾æ¥</h2>
                <div class="subscription-link" id="subscriptionLink">
                    https://raw.githubusercontent.com/ä½ çš„ç”¨æˆ·å/ä»“åº“å/main/output/clash.yaml
                </div>
                <button class="copy-btn" onclick="copySubscription()">å¤åˆ¶é“¾æ¥</button>
            </div>

            <!-- å›¾è¡¨ç»Ÿè®¡ -->
            <div class="charts-section">
                <div class="chart-card">
                    <h3>ğŸ“Š èŠ‚ç‚¹ç±»å‹åˆ†å¸ƒ</h3>
                    <div id="typeChart"></div>
                </div>
                <div class="chart-card">
                    <h3>ğŸŒ å›½å®¶/åœ°åŒºåˆ†å¸ƒ</h3>
                    <div id="countryChart"></div>
                </div>
            </div>

            <!-- ç«¯å£æŸ¥è¯¢ -->
            <div class="search-section">
                <h2>ğŸ” æŒ‰ç«¯å£æŸ¥è¯¢èŠ‚ç‚¹</h2>
                <div class="search-box">
                    <input type="number" id="portInput" placeholder="è¾“å…¥ç«¯å£å·ï¼Œä¾‹å¦‚ï¼š443" min="1" max="65535">
                    <button onclick="searchByPort()">æŸ¥è¯¢</button>
                </div>
                <div id="searchResults" class="results"></div>
            </div>
        </div>
    </div>

    <script>
        let nodesData = null;
        let statsData = null;
        let customSources = [];
        let mergedNodes = [];

        // åˆå§‹åŒ–
        function init() {
            loadCustomSources();
            loadData();
            displaySources();
        }

        // åŠ è½½è‡ªå®šä¹‰è®¢é˜…æº
        function loadCustomSources() {
            const saved = localStorage.getItem('customSources');
            if (saved) {
                customSources = JSON.parse(saved);
            }
        }

        // ä¿å­˜è‡ªå®šä¹‰è®¢é˜…æº
        function saveCustomSources() {
            localStorage.setItem('customSources', JSON.stringify(customSources));
        }

        // æ·»åŠ è®¢é˜…æº
        function addSource() {
            const input = document.getElementById('sourceInput');
            const url = input.value.trim();
            
            if (!url) {
                showError('è¯·è¾“å…¥è®¢é˜…æº URL');
                return;
            }

            if (!isValidUrl(url)) {
                showError('è¯·è¾“å…¥æœ‰æ•ˆçš„ URL');
                return;
            }

            if (customSources.includes(url)) {
                showError('è¯¥è®¢é˜…æºå·²å­˜åœ¨');
                return;
            }

            customSources.push(url);
            saveCustomSources();
            input.value = '';
            displaySources();
            showSuccess('è®¢é˜…æºæ·»åŠ æˆåŠŸï¼');
        }

        // åˆ é™¤è®¢é˜…æº
        function removeSource(url) {
            if (confirm('ç¡®å®šè¦åˆ é™¤è¿™ä¸ªè®¢é˜…æºå—ï¼Ÿ')) {
                customSources = customSources.filter(s => s !== url);
                saveCustomSources();
                displaySources();
                showSuccess('è®¢é˜…æºå·²åˆ é™¤');
            }
        }

        // æ˜¾ç¤ºè®¢é˜…æºåˆ—è¡¨
        function displaySources() {
            const list = document.getElementById('sourcesList');
            const totalSources = document.getElementById('totalSources');
            
            if (customSources.length === 0) {
                list.innerHTML = '<p style="color: #666; padding: 20px; text-align: center;">æš‚æ— è‡ªå®šä¹‰è®¢é˜…æºï¼Œè¯·æ·»åŠ </p>';
                totalSources.textContent = '0';
                return;
            }

            totalSources.textContent = customSources.length;
            list.innerHTML = '';
            
            customSources.forEach(url => {
                const item = document.createElement('div');
                item.className = 'source-item';
                item.innerHTML = `
                    <div class="source-url">${url}</div>
                    <div class="source-actions">
                        <button onclick="removeSource('${url}')" class="search-box button btn-small btn-danger">åˆ é™¤</button>
                    </div>
                `;
                list.appendChild(item);
            });
        }

        // æŠ“å–å¹¶åˆå¹¶èŠ‚ç‚¹
        async function fetchAndMergeNodes() {
            if (customSources.length === 0) {
                showError('è¯·å…ˆæ·»åŠ è®¢é˜…æº');
                return;
            }

            showSuccess('æ­£åœ¨æŠ“å–èŠ‚ç‚¹ï¼Œè¯·ç¨å€™...');
            mergedNodes = [];

            for (const url of customSources) {
                try {
                    const response = await fetch(url);
                    const text = await response.text();
                    
                    // å°è¯•è§£æ base64
                    let content = text;
                    if (isBase64(text)) {
                        content = atob(text);
                    }

                    // æŒ‰è¡Œåˆ†å‰²å¹¶è¿‡æ»¤
                    const lines = content.split('\n')
                        .map(line => line.trim())
                        .filter(line => line && isValidNode(line));
                    
                    mergedNodes.push(...lines);
                    console.log(`ä» ${url} è·å– ${lines.length} ä¸ªèŠ‚ç‚¹`);
                } catch (error) {
                    console.error(`æŠ“å–å¤±è´¥: ${url}`, error);
                }
            }

            // å»é‡
            mergedNodes = [...new Set(mergedNodes)];
            
            showSuccess(`æˆåŠŸæŠ“å– ${mergedNodes.length} ä¸ªèŠ‚ç‚¹ï¼`);
            
            // ç”Ÿæˆä¸‹è½½é“¾æ¥
            generateDownloadLinks();
        }

        // ç”Ÿæˆä¸‹è½½é“¾æ¥
        function generateDownloadLinks() {
            const base64Content = btoa(mergedNodes.join('\n'));
            const blob = new Blob([base64Content], { type: 'text/plain' });
            const url = URL.createObjectURL(blob);
            
            const downloadLink = document.createElement('a');
            downloadLink.href = url;
            downloadLink.download = 'merged_nodes.txt';
            downloadLink.textContent = 'ğŸ“¥ ä¸‹è½½åˆå¹¶åçš„èŠ‚ç‚¹ï¼ˆBase64ï¼‰';
            downloadLink.style.cssText = 'display: inline-block; margin-top: 10px; padding: 10px 20px; background: #28a745; color: white; text-decoration: none; border-radius: 6px;';
            
            const container = document.getElementById('sourcesList');
            const existingLink = container.querySelector('a');
            if (existingLink) {
                existingLink.remove();
            }
            container.appendChild(downloadLink);
        }

        // å¯¼å‡ºé…ç½®
        function exportConfig() {
            const config = {
                sources: customSources,
                exportTime: new Date().toISOString()
            };
            
            const blob = new Blob([JSON.stringify(config, null, 2)], { type: 'application/json' });
            const url = URL.createObjectURL(blob);
            const a = document.createElement('a');
            a.href = url;
            a.download = 'sources_config.json';
            a.click();
            URL.revokeObjectURL(url);
            
            showSuccess('é…ç½®å·²å¯¼å‡º');
        }

        // éªŒè¯ URL
        function isValidUrl(string) {
            try {
                new URL(string);
                return true;
            } catch (_) {
                return false;
            }
        }

        // æ£€æŸ¥æ˜¯å¦ä¸º base64
        function isBase64(str) {
            if (typeof str !== 'string') return false;
            const base64Regex = /^[A-Za-z0-9+/]+={0,2}$/;
            return base64Regex.test(str.replace(/\s/g, '')) && str.length % 4 === 0;
        }

        // æ£€æŸ¥æ˜¯å¦ä¸ºæœ‰æ•ˆèŠ‚ç‚¹
        function isValidNode(line) {
            const protocols = ['vmess://', 'vless://', 'trojan://', 'ss://', 'ssr://'];
            return protocols.some(protocol => line.startsWith(protocol));
        }

        // æ˜¾ç¤ºæˆåŠŸæ¶ˆæ¯
        function showSuccess(message) {
            const el = document.getElementById('successMessage');
            el.textContent = message;
            el.style.display = 'block';
            setTimeout(() => {
                el.style.display = 'none';
            }, 3000);
        }

        // æ˜¾ç¤ºé”™è¯¯æ¶ˆæ¯
        function showError(message) {
            const el = document.getElementById('errorMessage');
            el.textContent = message;
            el.style.display = 'block';
            setTimeout(() => {
                el.style.display = 'none';
            }, 3000);
        }

        // åŠ è½½æ•°æ®
        async function loadData() {
            try {
                // åŠ è½½ç»Ÿè®¡æ•°æ®
                const statsResponse = await fetch('output/stats.json');
                statsData = await statsResponse.json();

                // åŠ è½½èŠ‚ç‚¹æ•°æ®
                const nodesResponse = await fetch('output/nodes.json');
                nodesData = await nodesResponse.json();

                displayStats();
                displayCharts();
                
                document.getElementById('loading').style.display = 'none';
                document.getElementById('content').style.display = 'block';
            } catch (error) {
                document.getElementById('loading').style.display = 'none';
                document.getElementById('error').style.display = 'block';
                document.getElementById('error').textContent = 'åŠ è½½æ•°æ®å¤±è´¥: ' + error.message;
            }
        }

        // æ˜¾ç¤ºç»Ÿè®¡ä¿¡æ¯
        function displayStats() {
            document.getElementById('totalNodes').textContent = statsData.total;
            document.getElementById('totalCountries').textContent = Object.keys(statsData.byCountry).length;
            
            const updateTime = new Date(statsData.updateTime);
            document.getElementById('lastUpdate').textContent = updateTime.toLocaleString('zh-CN', {
                month: '2-digit',
                day: '2-digit',
                hour: '2-digit',
                minute: '2-digit'
            });

            // æ›´æ–°è®¢é˜…é“¾æ¥
            if (window.location.hostname.includes('github.io')) {
                const parts = window.location.pathname.split('/');
                const repo = parts[1];
                const username = window.location.hostname.split('.')[0];
                document.getElementById('subscriptionLink').textContent = 
                    `https://raw.githubusercontent.com/${username}/${repo}/main/output/clash.yaml`;
            } else if (window.location.hostname.includes('pages.dev')) {
                document.getElementById('subscriptionLink').textContent = 
                    `${window.location.origin}/output/clash.yaml`;
            }
        }

        // æ˜¾ç¤ºå›¾è¡¨
        function displayCharts() {
            // ç±»å‹åˆ†å¸ƒ
            const typeChart = document.getElementById('typeChart');
            typeChart.innerHTML = '';
            for (const [type, count] of Object.entries(statsData.byType)) {
                const item = document.createElement('div');
                item.className = 'chart-item';
                item.innerHTML = `
                    <span class="chart-label">${type.toUpperCase()}</span>
                    <span class="chart-value">${count}</span>
                `;
                typeChart.appendChild(item);
            }

            // å›½å®¶åˆ†å¸ƒ
            const countryChart = document.getElementById('countryChart');
            countryChart.innerHTML = '';
            const sortedCountries = Object.entries(statsData.byCountry)
                .sort((a, b) => b[1] - a[1])
                .slice(0, 10);
            
            for (const [country, count] of sortedCountries) {
                const item = document.createElement('div');
                item.className = 'chart-item';
                item.innerHTML = `
                    <span class="chart-label">${getCountryName(country)}</span>
                    <span class="chart-value">${count}</span>
                `;
                countryChart.appendChild(item);
            }
        }

        // æŒ‰ç«¯å£æœç´¢
        function searchByPort() {
            const port = parseInt(document.getElementById('portInput').value);
            const resultsDiv = document.getElementById('searchResults');
            
            if (!port || port < 1 || port > 65535) {
                resultsDiv.innerHTML = '<div class="error">è¯·è¾“å…¥æœ‰æ•ˆçš„ç«¯å£å· (1-65535)</div>';
                return;
            }

            const matchedNodes = nodesData.nodes.filter(node => node.port === port);
            
            if (matchedNodes.length === 0) {
                resultsDiv.innerHTML = `<div class="error">æœªæ‰¾åˆ°ä½¿ç”¨ç«¯å£ ${port} çš„èŠ‚ç‚¹</div>`;
                return;
            }

            resultsDiv.innerHTML = `<p style="margin-bottom: 15px; color: #667eea; font-weight: bold;">æ‰¾åˆ° ${matchedNodes.length} ä¸ªèŠ‚ç‚¹ä½¿ç”¨ç«¯å£ ${port}ï¼š</p>`;
            
            matchedNodes.forEach(node => {
                const nodeCard = document.createElement('div');
                nodeCard.className = 'node-card';
                nodeCard.innerHTML = `
                    <h4>${node.name}</h4>
                    <div class="node-info">
                        <span><span class="badge badge-type">${node.type.toUpperCase()}</span></span>
                        <span><span class="badge badge-country">${getCountryName(node.country)}</span></span>
                        <span><span class="badge badge-port">ç«¯å£: ${node.port}</span></span>
                        <span>æœåŠ¡å™¨: ${node.server}</span>
                    </div>
                `;
                resultsDiv.appendChild(nodeCard);
            });
        }

        // å¤åˆ¶è®¢é˜…é“¾æ¥
        function copySubscription() {
            const link = document.getElementById('subscriptionLink').textContent;
            navigator.clipboard.writeText(link).then(() => {
                alert('è®¢é˜…é“¾æ¥å·²å¤åˆ¶åˆ°å‰ªè´´æ¿ï¼');
            }).catch(err => {
                alert('å¤åˆ¶å¤±è´¥ï¼Œè¯·æ‰‹åŠ¨å¤åˆ¶');
            });
        }

        // è·å–å›½å®¶åç§°
        function getCountryName(code) {
            const countryNames = {
                'HK': 'ğŸ‡­ğŸ‡° é¦™æ¸¯',
                'TW': 'ğŸ‡¹ğŸ‡¼ å°æ¹¾',
                'JP': 'ğŸ‡¯ğŸ‡µ æ—¥æœ¬',
                'KR': 'ğŸ‡°ğŸ‡· éŸ©å›½',
                'SG': 'ğŸ‡¸ğŸ‡¬ æ–°åŠ å¡',
                'US': 'ğŸ‡ºğŸ‡¸ ç¾å›½',
                'CA': 'ğŸ‡¨ğŸ‡¦ åŠ æ‹¿å¤§',
                'GB': 'ğŸ‡¬ğŸ‡§ è‹±å›½',
                'DE': 'ğŸ‡©ğŸ‡ª å¾·å›½',
                'FR': 'ğŸ‡«ğŸ‡· æ³•å›½',
                'RU': 'ğŸ‡·ğŸ‡º ä¿„ç½—æ–¯',
                'IN': 'ğŸ‡®ğŸ‡³ å°åº¦',
                'AU': 'ğŸ‡¦ğŸ‡º æ¾³å¤§åˆ©äºš',
                'CN': 'ğŸ‡¨ğŸ‡³ ä¸­å›½',
                'Unknown': 'ğŸŒ æœªçŸ¥'
            };
            return countryNames[code] || code;
        }

        // é¡µé¢åŠ è½½æ—¶åˆå§‹åŒ–
        window.addEventListener('load', init);

        // å›è½¦é”®è§¦å‘æœç´¢
        document.addEventListener('DOMContentLoaded', function() {
            const portInput = document.getElementById('portInput');
            if (portInput) {
                portInput.addEventListener('keypress', function(e) {
                    if (e.key === 'Enter') {
                        searchByPort();
                    }
                });
            }

            const sourceInput = document.getElementById('sourceInput');
            if (sourceInput) {
                sourceInput.addEventListener('keypress', function(e) {
                    if (e.key === 'Enter') {
                        addSource();
                    }
                });
            }
        });
    </script>
</body>
</html>